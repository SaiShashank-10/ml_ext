# TASK 6 -------
# Logistic Regression --------

import numpy as np
import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LogisticRegression
from sklearn import metrics

col_names  = ['pregnent', 'glucose', 'bp', 'skin', 'bmi', 'insulin', 'pedigree', 'age', 'label']
data  = pd.read_csv(r'/content/diabetes (1).csv', header= None, names = col_names)
print(data)

feature_columns = ['pregnent', 'insulin','glucose', 'age', 'bmi']
X  = data[feature_columns]
y = data['label']

X_train, X_test, y_train, y_test = train_test_split(X , y, test_size  = 0.25, random_state = 0)

model = LogisticRegression(random_state = 0, solver = 'lbfgs', max_iter = 1000)
model.fit(X_train, y_train)

y_pred = model.predict(X_test)

conf_mat = metrics.confusion_matrix(y_test, y_pred)
print(conf_mat)

print("Accuracy: ", metrics.accuracy_score(y_test, y_pred))
print("Precision: ", metrics.precision_score(y_test, y_pred))

